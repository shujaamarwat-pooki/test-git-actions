name: Akimbo CI/CD

on:
  pull_request:
    branches:
      - development
  push:
    branches:
      - development

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Code
      uses: actions/checkout@v2

    - name: Set up Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '16'

    - name: Install Dependencies
      run: npm install

    - name: Populate Block List
      run: npm run populate
      
    - name: Give Execute Permission to Script
      run: chmod +x ./scripts/check_new.sh

    - name: Check new block
      run: ./scripts/check_new.sh

    - name: Lint and Test
      run: npm run lint

    - name: Build Angular Library
      run: npm run build

    # - name: Deploy to Server
    #   run: |
    #     npm run deploy  # or custom deployment script

  # notify:
  #   runs-on: ubuntu-latest
  #   needs: build
  #   steps:
  #   # Send notification to Slack
  #   - name: Notify Slack
  #     uses: slackapi/slack-github-action@v1.23.0
  #     with:
  #       payload: |
  #         {
  #           "text": "New block/component has been merged and deployed. View the details here: <link_to_block_page>"
  #         }
  #     env:
  #       SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
